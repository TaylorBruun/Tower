import{r as W,c as w,a as y,o as d,b as u,d as o,e as g,F as O,f as Y,g as E,t as h,h as T,S as P,i as G,u as q,M as Q,w as b,v as f,j as L,k as J,l as Z,m as X,n as ee,p as $,q as N,s as R,x as te,y as V,z as ne}from"./vendor.da070880.js";const oe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=t(s);fetch(s.href,c)}};oe();const i=W({user:{},account:{},events:[],comments:[],currTickets:[],eventsAttending:[],myTickets:[]});var p=(a,e)=>{for(const[t,n]of e)a[t]=n;return a};const ae={name:"App",setup(){return{appState:w(()=>i)}}},se=o("footer",null,null,-1);function re(a,e,t,n,s,c){const r=y("Navbar"),v=y("router-view");return d(),u(O,null,[o("header",null,[g(r)]),o("main",null,[g(v)]),se],64)}var ce=p(ae,[["render",re]]);const j=window.location.origin.includes("localhost"),M=j?"http://localhost:3000":"",ie="dev-9b4l8l0z.us.auth0.com",le="I4Pt8FlULkBPFovOcWdDDZSqO1uDJDQa",de="https://TayDev.com";function k(a,e){if(j)console[a](`[${a}] :: ${new Date().toLocaleTimeString()} :: `,...e);else{switch(a){case"log":case"assert":return}console[a](`[${a}] :: ${new Date().toLocaleTimeString()} :: `,...e)}}const l={log(){k("log",arguments)},error(){k("error",arguments)},warn(){k("warn",arguments)},assert(){k("assert",arguments)},trace(){k("trace",arguments)}},_=Y.create({baseURL:M,timeout:8e3});class ue{async getEventComments(e){const t=await _.get(`api/events/${e}/comments`);l.log("here are the comments",t.data),i.comments=t.data}async createComment(e){const t=await _.post("api/comments",e);l.log(t.data),i.comments.unshift(t.data)}async removeComment(e){const t=await _.delete(`api/comments/${e}`);l.log(t.data),i.comments=i.comments.filter(n=>n.id!=e)}}const _e=new ue;const me={props:{comment:{type:Object,required:!1}},setup(){return{async removeComment(a){await _e.removeComment(a)},account:w(()=>i.account)}}},ve={class:"col comment-card"},pe=["src"];function ge(a,e,t,n,s,c){return d(),u("div",ve,[o("h6",null,[o("img",{class:"comment-img",src:t.comment.creator.picture,alt:""},null,8,pe),E(" "+h(t.comment.creator.name),1)]),o("h6",null,[n.account.id==t.comment.creatorId?(d(),u("i",{key:0,onClick:e[0]||(e[0]=r=>n.removeComment(t.comment.id)),title:"Remove comment",class:"cancel-btn mdi mdi-close-circle"})):T("",!0),E(" "+h(t.comment.body),1)])])}var he=p(me,[["render",ge],["__scopeId","data-v-3f35295e"]]),be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:he});class fe{async getEvents(e=""){const t=await _.get("api/events"+e);l.log(t.data),i.events=t.data}async createEvent(e){const t=await _.post("api/events",e);return l.log(t.data),i.events.unshift(t.data),t.data}async cancelEvent(e){const t=await _.delete(`api/events/${e}`);l.log("deleting",t.data);let n=i.events.find(s=>s.id==e);return n.isCanceled=!n.isCanceled,t.data}getEventsForMyTickets(){let e=[];i.myTickets.forEach(t=>e.push(t.eventId)),i.eventsAttending=i.events.filter(t=>e.includes(t.id))}}const D=new fe;class I{static async confirm(e="Are you sure?",t="You won't be able to revert this!",n="warning",s="Yes, delete it!"){try{return!!(await P.fire({title:e,text:t,icon:n,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:s})).isConfirmed}catch{return!1}}static toast(e="Warning!",t="warning",n="top-end",s=3e3,c=!0){P.fire({title:e,icon:t,position:n,timer:s,timerProgressBar:c,toast:!0,showConfirmButton:!1})}static error(e){var t;if(e.isAxiosError){const{response:n}=e;this.toast(((t=n.data.error)==null?void 0:t.message)||n.data.message,"error")}else this.toast(e.message||e,"error")}static success(e="Success!"){this.toast(e,"success")}}const ye={props:{event:{type:Object,required:!1}},setup(){let a=G({});const e=q();return{editable:a,async createEvent(){try{let t=a.value,n=await D.createEvent(t);l.log("here is the new event",n),I.toast("Event listed","success"),Q.getOrCreateInstance(document.getElementById("create-event")).hide(),e.push({name:"EventDetails",params:{id:n.id}}),a.value={}}catch(t){I.error(t)}}}}},ke={class:"row flex-column"},we={class:"col"},Ee=o("label",{class:"text-dark m-2"},"Event Name: ",-1),Te={class:"col"},xe=o("label",{class:"text-dark m-2"},"Location: ",-1),Ce={class:"col"},Se=o("label",{class:"text-dark m-2"},"Type: ",-1),Ae={class:"col"},$e=o("label",{class:"text-dark m-2"},"Capacity: ",-1),De={class:"col"},Ie=o("label",{class:"text-dark m-2"},"Start Date: ",-1),Oe={class:"col"},Pe=o("label",{class:"text-dark m-2"},"Cover Image: ",-1),qe={class:"col"},Le=o("label",{class:"text-dark m-2"},"Description: ",-1),Ne=o("button",{class:"btn btn-warning",type:"button ","data-bs-dismiss":"modal"},"Cancel!",-1);function Re(a,e,t,n,s,c){return d(),u("div",ke,[o("form",{onSubmit:e[8]||(e[8]=L((...r)=>n.createEvent&&n.createEvent(...r),["prevent"])),id:"event-form"},[o("div",we,[Ee,b(o("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>n.editable.name=r),type:"text",name:"name",id:"name","aria-describedby":"helpId",required:""},null,512),[[f,n.editable.name]])]),o("div",Te,[xe,b(o("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>n.editable.location=r),type:"text",name:"location",id:"location","aria-describedby":"helpId",required:""},null,512),[[f,n.editable.location]])]),o("div",Ce,[Se,b(o("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>n.editable.type=r),type:"text",name:"type",id:"type","aria-describedby":"helpId",required:""},null,512),[[f,n.editable.type]])]),o("div",Ae,[$e,b(o("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>n.editable.capacity=r),type:"number",name:"capacity",id:"capacity","aria-describedby":"helpId",required:""},null,512),[[f,n.editable.capacity]])]),o("div",De,[Ie,b(o("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>n.editable.startDate=r),type:"date",name:"startDate",id:"startDate","aria-describedby":"helpId",required:""},null,512),[[f,n.editable.startDate]])]),o("div",Oe,[Pe,b(o("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>n.editable.coverImg=r),type:"text",name:"coverImg",id:"coverImg","aria-describedby":"helpId",required:""},null,512),[[f,n.editable.coverImg]])]),o("div",qe,[Le,b(o("textarea",{"onUpdate:modelValue":e[6]||(e[6]=r=>n.editable.description=r),name:"description",id:"description",required:""},null,512),[[f,n.editable.description]])]),t.event?T("",!0):(d(),u("button",{key:0,class:"btn btn-success",type:"button ",onClick:e[7]||(e[7]=()=>{})}," Create! ")),Ne],32)])}var U=p(ye,[["render",Re]]),Ve=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:U});const je="modulepreload",H={},Me="/",x=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${Me}${n}`,n in H)return;H[n]=!0;const s=n.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${c}`))return;const r=document.createElement("link");if(r.rel=s?"stylesheet":je,s||(r.as="script",r.crossOrigin=""),r.href=n,document.head.appendChild(r),s)return new Promise((v,A)=>{r.addEventListener("load",v),r.addEventListener("error",A)})})).then(()=>e())};function Ue(a){switch(a){case"./pages/AboutPage.vue":return x(()=>import("./AboutPage.9c19ea40.js"),["assets/AboutPage.9c19ea40.js","assets/vendor.da070880.js"]);case"./pages/AccountPage.vue":return x(()=>import("./AccountPage.f8015820.js"),["assets/AccountPage.f8015820.js","assets/AccountPage.4e517f9a.css","assets/vendor.da070880.js"]);case"./pages/EventDetailsPage.vue":return x(()=>import("./EventDetailsPage.0213e02d.js"),["assets/EventDetailsPage.0213e02d.js","assets/EventDetailsPage.8a780f30.css","assets/vendor.da070880.js"]);case"./pages/HomePage.vue":return x(()=>import("./HomePage.da8024be.js"),["assets/HomePage.da8024be.js","assets/vendor.da070880.js"]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}function C(a){return()=>Ue(`./pages/${a}.vue`)}const He=[{path:"/",name:"Home",component:C("HomePage")},{path:"/about",name:"About",component:C("AboutPage")},{path:"/account",name:"Account",component:C("AccountPage"),beforeEnter:X},{path:"/event/:id",name:"EventDetails",component:C("EventDetailsPage")}],z=J({linkActiveClass:"router-link-active",linkExactActiveClass:"router-link-exact-active",history:Z(),routes:He});class ze{async getAccount(){try{const e=await _.get("/account");i.account=e.data}catch(e){l.error("HAVE YOU STARTED YOUR SERVER YET???",e)}}}const Be=new ze,Fe={connection:"connection",connected:"connected",disconnect:"disconnect",authenticate:"authenticate",authenticated:"authenticated",userConnected:"userConnected",userDisconnected:"userDisconnected",error:"error"};class Ke{constructor(e=!1,t=M){}on(e,t){var n;return(n=this.socket)==null||n.on(e,t.bind(this)),this}onConnected(e){l.log("[SOCKET_CONNECTION]",e),this.connected=!0,this.playback()}onAuthenticated(e){l.log("[SOCKET_AUTHENTICATED]",e),this.authenticated=!0,this.playback()}authenticate(e){var t;(t=this.socket)==null||t.emit(Fe.authenticate,e)}onError(e){l.error("[SOCKET_ERROR]",e)}enqueue(e,t){l.log("[ENQUEING_ACTION]",{action:e,payload:t}),this.queue.push({action:e,payload:t})}playback(){l.log("[SOCKET_PLAYBACK]");const e=[...this.queue];this.queue=[],e.forEach(t=>{this.emit(t.action,t.payload)})}emit(e,t=void 0){if(this.requiresAuth&&!this.authenticated)return this.enqueue(e,t);if(!this.connected)return this.enqueue(e,t);this.socket.emit(e,t)}}class We extends Ke{constructor(){super();this.on("error",this.onError)}onError(e){I.toast(e.message,"error")}}const B=new We,m=ee({domain:ie,clientId:le,audience:de,useRefreshTokens:!0,onRedirectCallback:a=>{z.push(a&&a.targetUrl?a.targetUrl:window.location.pathname)}});m.on(m.AUTH_EVENTS.AUTHENTICATED,async function(){_.defaults.headers.authorization=m.bearer,_.interceptors.request.use(Ye),i.user=m.user,await Be.getAccount(),B.authenticate(m.bearer)});async function Ye(a){if(!m.isAuthenticated)return a;const e=m.identity.exp*1e3,t=e<Date.now(),n=e<Date.now()+1e3*60*60*12;return t?await m.loginWithPopup():n&&(await m.getTokenSilently(),_.defaults.headers.authorization=m.bearer,B.authenticate(m.bearer)),a}const Ge={setup(){return{user:w(()=>i.user),account:w(()=>i.account),async login(){m.loginWithPopup()},async logout(){m.logout({returnTo:window.location.origin})}}}},F=a=>(N("data-v-b5f30be8"),a=a(),R(),a),Qe={class:"navbar-text"},Je={key:1,class:"dropdown my-2 my-lg-0"},Ze={class:"dropdown-toggle selectable","data-bs-toggle":"dropdown","aria-expanded":"false",id:"authDropdown"},Xe={key:0},et=["src"],tt={class:"mx-3 text-success lighten-30"},nt={class:"dropdown-menu p-0 list-group w-100","aria-labelledby":"authDropdown"},ot=F(()=>o("div",{class:"list-group-item list-group-item-action hoverable"}," Manage Account ",-1)),at=F(()=>o("i",{class:"mdi mdi-logout"},null,-1)),st=E(" logout "),rt=[at,st];function ct(a,e,t,n,s,c){const r=y("router-link");return d(),u("span",Qe,[n.user.isAuthenticated?(d(),u("div",Je,[o("div",Ze,[n.account.picture?(d(),u("div",Xe,[o("img",{src:n.account.picture,alt:"account photo",height:"40",class:"rounded"},null,8,et),o("span",tt,h(n.account.name),1)])):T("",!0)]),o("div",nt,[g(r,{to:{name:"Account"}},{default:$(()=>[ot]),_:1}),o("div",{class:"list-group-item list-group-item-action hoverable text-danger",onClick:e[1]||(e[1]=(...v)=>n.logout&&n.logout(...v))},rt)])])):(d(),u("button",{key:0,class:"btn selectable text-success lighten-30 text-uppercase my-2 my-lg-0",onClick:e[0]||(e[0]=(...v)=>n.login&&n.login(...v))}," Login "))])}var it=p(Ge,[["render",ct],["__scopeId","data-v-b5f30be8"]]),lt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:it});const dt={setup(){return{}},components:{EventForm:U}},S=a=>(N("data-v-3e834910"),a=a(),R(),a),ut={class:"navbar navbar-expand navbar-dark bg-dark px-3"},_t=S(()=>o("div",{class:"d-flex flex-column align-items-center"}," Tower ",-1)),mt=S(()=>o("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[o("span",{class:"navbar-toggler-icon"})],-1)),vt={class:"collapse navbar-collapse",id:"navbarText"},pt={class:"navbar-nav me-auto"},gt=E(" Account "),ht={class:"modal fade",id:"create-event",tabindex:"-1",role:"dialog","aria-labelledby":"modelTitleId","aria-hidden":"true"},bt={class:"modal-dialog",role:"document"},ft={class:"modal-content"},yt=S(()=>o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Create a new event"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),kt={class:"modal-body"},wt=S(()=>o("div",{class:"modal-footer"},null,-1));function Et(a,e,t,n,s,c){const r=y("router-link"),v=y("Login"),A=y("EventForm");return d(),u(O,null,[o("nav",ut,[g(r,{class:"navbar-brand d-flex",to:{name:"Home"}},{default:$(()=>[_t]),_:1}),mt,o("div",vt,[o("ul",pt,[o("li",null,[g(r,{to:{name:"Account"},class:"btn text-success lighten-30 selectable text-uppercase"},{default:$(()=>[gt]),_:1})]),o("li",null,[o("button",{onClick:e[0]||(e[0]=()=>{}),"data-bs-toggle":"modal","data-bs-target":"#create-event",class:"btn text-success lighten-30 selectable text-uppercase"}," New Event ")])]),g(v)])]),o("div",ht,[o("div",bt,[o("div",ft,[yt,o("div",kt,[g(A)]),wt])])])],64)}var Tt=p(dt,[["render",Et],["__scopeId","data-v-3e834910"]]),xt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Tt});const Ct={setup(){return{}}},St={class:"component"};function At(a,e,t,n,s,c){return d(),u("div",St)}var $t=p(Ct,[["render",At]]),Dt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:$t});const It={props:{ticket:{type:Object,required:!1}},setup(){return{}}},Ot={class:""},Pt=["title","src"];function qt(a,e,t,n,s,c){return d(),u("div",Ot,[o("img",{title:t.ticket.account.name,class:"attending-img",src:t.ticket.account.picture,alt:""},null,8,Pt)])}var Lt=p(It,[["render",qt],["__scopeId","data-v-cd949c88"]]),Nt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Lt});class Rt{async getMyTickets(){const e=await _.get("account/tickets");l.log(e.data),i.myTickets=e.data}async getEventTickets(e){l.log("retrieving tickets for",e);const t=await _.get(`api/events/${e}/tickets`);l.log("here are the tickets",t.data),i.currTickets=t.data}async createTicket(e){const t=await _.post("api/tickets",e);l.log(t.data),i.currTickets.push(t.data),await D.getEvents()}async deleteTicket(e){let t=i.myTickets.find(s=>s.eventId==e);const n=await _.delete(`api/tickets/${t.id}`);l.log(n.data),i.eventsAttending.filter(s=>s.id!=e),await this.getMyTickets(),await D.getEventsForMyTickets()}}const Vt=new Rt;const jt={props:{events:{type:Object,required:!0}},setup(a){const e=q();return{route:te(),formatDate(n){return new Date(n).toLocaleDateString()},selectEvent(){l.log("pushing with id",a.events.id),e.push({name:"EventDetails",params:{id:a.events.id}})},async deleteTicket(n){l.log("calling delete on",n),await Vt.deleteTicket(n)}}}},Mt=["src"],Ut={class:"text-muted"};function Ht(a,e,t,n,s,c){return d(),u("div",{onClick:e[1]||(e[1]=(...r)=>n.selectEvent&&n.selectEvent(...r)),class:"event-card selectable elevation-4 p-2 m-2 col-5"},[o("img",{class:"img-fluid",src:t.events.coverImg,alt:""},null,8,Mt),n.route.name=="Account"?(d(),u("button",{key:0,onClick:e[0]||(e[0]=L(r=>n.deleteTicket(t.events.id),["stop"])),class:"btn btn-danger"},"Delete Ticket")):T("",!0),o("h6",Ut,h(n.formatDate(t.events.startDate)),1),o("h3",{class:V({"text-decoration-line-through":t.events.isCanceled})},h(t.events.name),3),o("h5",null,h(t.events.location),1),o("h6",{class:V({"text-danger":t.events.capacity<=0})},"Tickets remaining: "+h(t.events.capacity),3)])}var zt=p(jt,[["render",Ht],["__scopeId","data-v-e6a3e9f8"]]),Bt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:zt});function Ft(a){Object.entries({"./components/Comment.vue":be,"./components/EventForm.vue":Ve,"./components/Login.vue":lt,"./components/Navbar.vue":xt,"./components/Ticket.vue":Dt,"./components/TicketHolder.vue":Nt,"./components/TowerEvent.vue":Bt}).forEach(([t,n])=>{const s=n.name||t.substr(t.lastIndexOf("/")+1).replace(/\.\w+$/,"");a.component(s,n.default)})}const K=ne(ce);Ft(K);K.use(z).mount("#app");export{i as A,he as C,U as E,I as P,zt as T,p as _,Lt as a,_e as c,D as e,Vt as t};
