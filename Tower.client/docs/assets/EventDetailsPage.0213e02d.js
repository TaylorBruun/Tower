import{i as I,x as T,A as D,c as v,a as k,o as s,b as m,d as a,h as u,g as r,t as i,y as h,F as C,B as y,w as E,v as S,j as A,q as B,s as P,C as g,p as V}from"./vendor.da070880.js";import{_ as j,e as f,t as p,c as b,P as _,A as l,a as H,C as M}from"./index.e3eab415.js";const N={setup(){let o=I("");const n=T();return D(async()=>{try{await f.getEvents(),await p.getEventTickets(n.params.id),await b.getEventComments(n.params.id)}catch(t){_.error(t)}}),{editable:o,formatDate(t){return new Date(t).toLocaleDateString()},alreadyAttending(t){return l.currTickets.find(d=>d.eventId==t&&d.accountId==l.account.id)},async createComment(){let t={};t.body=o.value,t.eventId=n.params.id;try{await b.createComment(t),o.value=""}catch(e){_.error(e)}},async cancelEvent(){try{await f.cancelEvent(n.params.id)}catch(t){_.error(t)}},async createTicket(t){let e={};e.eventId=t,e.accountId=l.account.id;try{await p.createTicket(e)}catch(d){_.error(d)}},account:v(()=>l.account),comments:v(()=>l.comments),events:v(()=>l.events.find(t=>t.id==n.params.id)),tickets:v(()=>l.currTickets)}},components:{TicketHolder:H,Comment:M}},F=o=>(B("data-v-c0a7b3e6"),o=o(),P(),o),L={class:"row"},q=["src"],z=r(),R=["src"],U={class:"text-muted"},G=r("Attending: "),J=r("7"),K=r("Comments: "),O=r(),Q=F(()=>a("button",{class:"btn btn-primary m-1"},"Comment",-1));function W(o,n,t,e,d,X){const w=k("TicketHolder"),x=k("Comment");return s(),m("div",L,[a("img",{class:"event-img img-fluid",src:e.events.coverImg,alt:""},null,8,q),z,e.events.capacity>0&&!e.events.isCanceled&&!e.alreadyAttending(e.events.id)?(s(),m("button",{key:0,onClick:n[0]||(n[0]=c=>e.createTicket(e.events.id)),class:"btn btn-success m-1"},"Attend")):u("",!0),a("h5",null,[a("img",{class:"img-fluid",src:e.events.creator.picture,alt:""},null,8,R),r(i(e.events.creator.name),1)]),a("h6",U,i(e.formatDate(e.events.startDate)),1),a("h3",{class:h({"text-decoration-line-through":e.events.isCanceled})},[r(i(e.events.name)+" ",1),e.account.id==e.events.creatorId?(s(),m("i",{key:0,onClick:n[1]||(n[1]=(...c)=>e.cancelEvent&&e.cancelEvent(...c)),title:"Cancel event",class:"cancel-btn mdi mdi-close-circle"})):u("",!0)],2),a("h5",null,i(e.events.location),1),a("h6",{class:h({"text-danger":e.events.capacity<=0})},i(e.events.isCanceled?"It's canceled :(":"It's on!")+" Tickets remaining: "+i(e.events.capacity),3),a("h6",null,i(e.events.description),1),a("h6",null,[G,(s(!0),m(C,null,y(e.tickets,c=>(s(),g(w,{key:c.id,ticket:c},{default:V(()=>[J]),_:2},1032,["ticket"]))),128))]),a("h6",null,[K,(s(!0),m(C,null,y(e.comments,c=>(s(),g(x,{key:c.id,comment:c},null,8,["comment"]))),128))]),a("form",{onSubmit:n[3]||(n[3]=A((...c)=>e.createComment&&e.createComment(...c),["prevent"])),action:""},[E(a("input",{"onUpdate:modelValue":n[2]||(n[2]=c=>e.editable=c),type:"text",placeholder:"Comment on this event"},null,512),[[S,e.editable]]),O,Q],32)])}var $=j(N,[["render",W],["__scopeId","data-v-c0a7b3e6"]]);export{$ as default};
